{"version":3,"sources":["../../src/resolvers/LocationGroup.js"],"names":["LocationGroup","users","parent","args","ctx","db","usersConnection","where","locationGroups_some","id","aggregate","count","usersCount","locationGroup","messages","groupMessages","AND","type","to","first"],"mappings":";;;;;;;;;;;AAAO,IAAMA,aAAa,GAAG;AACzBC,EAAAA,KAAK;AAAA;AAAA;AAAA,4BAAE,iBAAOC,MAAP,EAAeC,IAAf,EAAqBC,GAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACoBA,GAAG,CAACC,EAAJ,CACxBC,eADwB,CACR;AAACC,gBAAAA,KAAK,EAAC;AAACC,kBAAAA,mBAAmB,EAAC;AAACC,oBAAAA,EAAE,EAACP,MAAM,CAACO;AAAX;AAArB;AAAP,eADQ,EAExBC,SAFwB,GAGxBC,KAHwB,EADpB;;AAAA;AACCC,cAAAA,UADD;;AAAA,oBAKDA,UAAU,GAAC,GALV;AAAA;AAAA;AAAA;;AAAA,+CAOI,EAPJ;;AAAA;AAAA,+CASER,GAAG,CAACC,EAAJ,CAAOQ,aAAP,CAAqB;AAAEJ,gBAAAA,EAAE,EAAEP,MAAM,CAACO;AAAb,eAArB,EAAwCR,KAAxC,EATF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,KADoB;AAYzBa,EAAAA,QAAQ;AAAA;AAAA;AAAA,4BAAC,kBAAOZ,MAAP,EAAeC,IAAf,EAAqBC,GAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEqBA,GAAG,CAACC,EAAJ,CAAOU,aAAP,CAAqB;AAC/CR,gBAAAA,KAAK,EAAC;AACJS,kBAAAA,GAAG,EAAC,CACF;AAACC,oBAAAA,IAAI,EAAC;AAAN,mBADE,EAEF;AAACC,oBAAAA,EAAE,EAAChB,MAAM,CAACO;AAAX,mBAFE;AADA,iBADyC;AAO/CU,gBAAAA,KAAK,EAAC;AAPyC,eAArB,CAFrB;;AAAA;AAEDJ,cAAAA,aAFC;AAAA,gDAYAA,aAZA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAZiB,CAAtB","sourcesContent":["export const LocationGroup = {\r\n    users: async (parent, args, ctx) => {\r\n      const usersCount = await ctx.db\r\n      .usersConnection({where:{locationGroups_some:{id:parent.id}}})\r\n      .aggregate()\r\n      .count()\r\n      if (usersCount>500){\r\n        // 人数大于500不在返回具体人员信息\r\n        return []\r\n      }\r\n      return ctx.db.locationGroup({ id: parent.id }).users()\r\n    },\r\n    messages:async (parent, args, ctx) =>{\r\n\r\n      const groupMessages = await ctx.db.groupMessages({\r\n        where:{\r\n          AND:[\r\n            {type:\"FellowTownsman\"},\r\n            {to:parent.id},\r\n          ]\r\n        },\r\n        first:10\r\n      })\r\n\r\n      return groupMessages\r\n\r\n    }\r\n  }\r\n  "],"file":"LocationGroup.js"}